
  door2:
    image: swe544app
    networks:
      - kafka-network
    depends_on:
      - kafka
    deploy:
      replicas: 1
    environment:
      DOOR_CLUSTER_NUMBER: "door2"
      DOOR_CLUSTER_CARS_COUNTER_PATH: "INSTANCE_{{.Task.Slot}}_CAR_COUNTER"
      INSTANCE_NUMBER: "INSTANCE_{{.Task.Slot}}"
      NEXT_DOOR_CLUSTER_NUMBER: "door3"
      ADDRESS: "kafka"
    hostname: "door2-{{.Task.Slot}}"
    volumes:
      - ./entrypoint.sh:/entrypoint.sh
    command: sh /entrypoint.sh
    ports:
      - "8080"

  door3:
    image: swe544app
    networks:
      - kafka-network
    depends_on:
      - kafka
    deploy:
      replicas: 1
    environment:
      DOOR_CLUSTER_NUMBER: "door3"
      DOOR_CLUSTER_CARS_COUNTER_PATH: "INSTANCE_{{.Task.Slot}}_CAR_COUNTER"
      INSTANCE_NUMBER: "INSTANCE_{{.Task.Slot}}"
      NEXT_DOOR_CLUSTER_NUMBER: "door4"
      ADDRESS: "kafka"
    hostname: "door3-{{.Task.Slot}}"
    volumes:
      - ./entrypoint.sh:/entrypoint.sh
    command: sh /entrypoint.sh
    ports:
      - "8080"

  door4:
    image: swe544app
    networks:
      - kafka-network
    depends_on:
      - kafka
    deploy:
      replicas: 1
    environment:
      DOOR_CLUSTER_NUMBER: "door4"
      DOOR_CLUSTER_CARS_COUNTER_PATH: "INSTANCE_{{.Task.Slot}}_CAR_COUNTER"
      INSTANCE_NUMBER: "INSTANCE_{{.Task.Slot}}"
      NEXT_DOOR_CLUSTER_NUMBER: "door1"
      ADDRESS: "kafka"
    hostname: "door4-{{.Task.Slot}}"
    volumes:
      - ./entrypoint.sh:/entrypoint.sh
    command: sh /entrypoint.sh
    ports:
      - "8080"
